<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restablecer Contraseña - Gestión de Stocks</title>
    <link rel="icon" type="image/x-icon" href="/assets/faviconjobers.ico">
    <script>
        // Inyectar colores del tema ANTES del CSS para evitar flash
        (function () {
            const themes = {
                'rubi': { primary: '#FF4338', primaryDark: '#D32F2F', primaryLight: '#FF6B6B' },
                'zafiro': { primary: '#2196F3', primaryDark: '#1565C0', primaryLight: '#64B5F6' },
                'esmeralda': { primary: '#4CAF50', primaryDark: '#2E7D32', primaryLight: '#81C784' },
                'amatista': { primary: '#9C27B0', primaryDark: '#6A1B9A', primaryLight: '#BA68C8' },
                'ambar': { primary: '#FF9800', primaryDark: '#E65100', primaryLight: '#FFB74D' },
                'grafito': { primary: '#607D8B', primaryDark: '#37474F', primaryLight: '#90A4AE' },
                'corporativo': { primary: '#1a365d', primaryDark: '#0d1b2a', primaryLight: '#2c5282' },
                'ejecutivo': { primary: '#2d3748', primaryDark: '#1a202c', primaryLight: '#4a5568' },
                'oceano': { primary: '#0077b6', primaryDark: '#023e8a', primaryLight: '#0096c7' },
                'bosque': { primary: '#2d6a4f', primaryDark: '#1b4332', primaryLight: '#40916c' },
                'vino': { primary: '#722f37', primaryDark: '#4a1c23', primaryLight: '#a4343a' },
                'medianoche': { primary: '#1e3a5f', primaryDark: '#0d1b2a', primaryLight: '#2e5077' },
                'titanio': { primary: '#4a5568', primaryDark: '#2d3748', primaryLight: '#718096' },
                'bronce': { primary: '#8b5a2b', primaryDark: '#5c3d1e', primaryLight: '#a0522d' },
                'elegante': { primary: '#FF4438', primaryDark: '#1a1a1a', primaryLight: '#FF6B5B' }
            };
            const theme = localStorage.getItem('theme') || 'dark';
            const colorTheme = localStorage.getItem('colorTheme') || 'rubi';
            const colors = themes[colorTheme] || themes['rubi'];

            document.documentElement.setAttribute('data-theme', theme);
            document.documentElement.setAttribute('data-color-theme', colorTheme);

            const style = document.createElement('style');
            style.id = 'theme-colors-inline';
            style.textContent = ':root{--primary:' + colors.primary + '!important;--primary-dark:' + colors.primaryDark + '!important;--primary-light:' + colors.primaryLight + '!important}';
            document.head.appendChild(style);
        })();
    </script>
    <link rel="stylesheet" href="css/styles.css?v=1.27.1">
</head>
<body>
    <!-- Selector de idioma y tema fijo -->
    <div class="login-top-controls">
        <div class="theme-toggle-login">
            <span class="theme-icon" id="theme-icon" onclick="toggleTheme()">&#9728;&#65039;</span>
            <label class="switch">
                <input type="checkbox" id="theme-switch" checked onchange="toggleTheme()">
                <span class="slider"></span>
            </label>
        </div>
        <select id="lang-selector" class="lang-selector" onchange="I18n.setLanguage(this.value)">
            <option value="es">ES</option>
            <option value="en">EN</option>
            <option value="fr">FR</option>
        </select>
    </div>

    <div class="login-wrapper">
        <div class="login-sidebar">
            <div class="sidebar-content">
                <img id="sidebar-logo" src="assets/logojobers.png" alt="Logo" class="sidebar-logo">
                <h2 data-i18n="header.title">Gestión de Stocks</h2>
                <p><span data-i18n="header.subtitle">Sistema de consulta de inventario en tiempo real</span></p>
            </div>
        </div>

        <div class="login-container">
            <div class="login-box">
                <div class="login-header">
                    <img id="mobile-logo" src="assets/logojobers.png" alt="Logo" class="mobile-logo">
                    <script>
                        // Cargar logo desde localStorage inmediatamente para evitar flash
                        (function() {
                            const logoUrl = localStorage.getItem('logoUrl');
                            if (logoUrl) {
                                document.getElementById('sidebar-logo').src = logoUrl;
                                document.getElementById('mobile-logo').src = logoUrl;
                            }
                        })();
                    </script>
                    <h1 data-i18n="auth.resetPasswordTitle">Nueva contraseña</h1>
                    <p class="login-subtitle" data-i18n="auth.resetPasswordSubtitle">Introduce tu nueva contraseña</p>
                </div>

                <div id="alert-container"></div>

                <form class="login-form" id="reset-password-form" method="POST" action="#">
                    <div class="form-group">
                        <label for="new-password" data-i18n="changePassword.newPassword">Nueva Contraseña</label>
                        <div class="password-wrapper">
                            <input
                                type="password"
                                id="new-password"
                                required
                                autocomplete="new-password"
                                data-i18n-placeholder="authPlaceholders.passwordRegister"
                                placeholder="Mínimo 8 caracteres"
                            >
                            <button type="button" class="password-toggle" onclick="togglePassword('new-password', this)" aria-label="Mostrar contraseña">
                                <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                    <circle cx="12" cy="12" r="3"/>
                                </svg>
                                <svg class="eye-off-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                                    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                                    <line x1="1" y1="1" x2="23" y2="23"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="confirm-password" data-i18n="changePassword.confirmPassword">Confirmar Nueva Contraseña</label>
                        <div class="password-wrapper">
                            <input
                                type="password"
                                id="confirm-password"
                                required
                                autocomplete="new-password"
                                data-i18n-placeholder="authPlaceholders.passwordConfirm"
                                placeholder="Repite la contraseña"
                            >
                            <button type="button" class="password-toggle" onclick="togglePassword('confirm-password', this)" aria-label="Mostrar contraseña">
                                <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                    <circle cx="12" cy="12" r="3"/>
                                </svg>
                                <svg class="eye-off-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                                    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                                    <line x1="1" y1="1" x2="23" y2="23"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <button type="submit" class="btn-login" id="btn-reset" data-i18n="auth.resetPasswordButton">
                        Cambiar contraseña
                    </button>
                </form>

                <div class="login-link" style="margin-top: 15px;">
                    <a href="#" id="back-to-login-link" data-i18n="verification.backToLogin">Volver al login</a>
                </div>
            </div>
        </div>
    </div>

    <script src="js/i18n/i18n.js"></script>
    <script src="js/reset-password.js"></script>
</body>
</html>
